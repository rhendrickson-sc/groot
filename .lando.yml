name: groot
recipe: wordpress
config:
  webroot: wp

services:
  appserver:
    build:
      - cd $LANDO_MOUNT && composer install
      - cd $LANDO_MOUNT && scripts/setup-wordpress.bash

  node:
    type: node:6.11

    globals:
      webpack: "4.0.0"
      grunt-cli: "1.2.0"
      yarn: "1.5.1"

    build:
      - cd $LANDO_MOUNT && yarn install

  phpmyadmin:
    type: phpmyadmin:4.7

  mailhog:
    type: mailhog:v1.0.0
    hogfrom:
      - appserver

tooling:
  install:
    service: appserver
    cmd: '/app/scripts/setup-wordpress.bash'
    description: 'Install and configure WordPress for custom theme dev'

  yarn:
    service: node

  grunt:
    service: node

  webpack:
    service: node

  debug:
    service: appserver
    cmd: 'tail -f /app/wp/wp-content/debug.log'
    description: 'Watch the WP debug log in real time'

proxy:
  appserver:
    - groot.lndo.site

  mailhog:
    - mail.groot.lndo.site
